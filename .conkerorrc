allow_browser_window_close = false;

cwd=get_home_directory();
cwd.append("downloads");

download_buffer_automatic_open_target=OPEN_NEW_BUFFER_BACKGROUND;
hint_digits="0abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ";
url_remoting_fn = load_url_in_new_buffer;

add_hook("mode_line_hook", mode_line_adder(downloads_status_widget));
add_hook("mode_line_hook", mode_line_adder(buffer_count_widget), true);
remove_hook("mode_line_hook", mode_line_adder(clock_widget));

define_variable("firebug_url",
    "http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js");

function firebug (I) {
    var doc = I.buffer.document;
    var script = doc.createElement('script');
    script.setAttribute('type', 'text/javascript');
    script.setAttribute('src', firebug_url);
    script.setAttribute('onload', 'firebug.init();');
    doc.body.appendChild(script);
}
interactive("firebug", "open firebug lite", firebug);
define_key(content_buffer_normal_keymap, "f12", "firebug");

define_key(content_buffer_normal_keymap, "d", "follow-new-buffer-background");
define_key(content_buffer_normal_keymap, "j", "content-policy-toggle");

define_webjump("github", "http://github.com/search?q=%s&type=Everything");
define_webjump("krautchan", "https://krautchan.net/board/%s");
define_webjump("logs", "http://logs.2pktfkt.de/%s");
define_webjump("reddit","http://www.reddit.com/r/%s");

register_user_stylesheet(
    "data:text/css," + escape(
        "@namespace url(\"http://www.w3.org/1999/xhtml\");" +
        "span.__conkeror_hint { font-size: 18px !important; line-height: 18px !important; }" +
        "[title] { border-bottom: 2px dotted !important; position: relative; }" +
        "[title]:hover::after { background-color: white; border: 2px solid !important; color: black; content: attr(title); left: 0; position: absolute; top: 1.5em; z-index: 1; }"
    )
);

require("block-content-focus-change.js");

require("content-policy.js");
function block_content(content_type, content_location) {
    if (content_location.host == "localhost") {
        return content_policy_accept;
    } else {
        return content_policy_reject;
    };
};

content_policy_bytype_table.font = block_content;
content_policy_bytype_table.image = block_content;
content_policy_bytype_table.media = block_content;
content_policy_bytype_table.object = block_content;
content_policy_bytype_table.script = block_content;
add_hook("content_policy_hook", content_policy_bytype);

require("favicon");
add_hook("mode_line_hook", mode_line_adder(buffer_icon_widget), true);

session_pref("intl.accept_languages", "de-de, de, en-us, en");

set_protocol_handler("mailto", find_file_in_path("claws-mail"));
